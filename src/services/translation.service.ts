import { Injectable, signal, computed } from '@angular/core';

type Language = 'en' | 'fr' | 'pt' | 'sw';

const TRANSLATIONS: { [key in Language]: { [key: string]: string } } = {
  en: {
    title: 'ICAO NOTAM Builder',
    templatesTitle: 'Quick-Fill Templates',
    selectTemplatePlaceholder: 'Select a template...',
    template_rwy_clsd: 'Runway Closed',
    template_twy_wip: 'Taxiway Work-in-Progress',
    template_vor_unserv: 'VOR Unserviceable',
    step1: '1. Type',
    step2: '2. Details',
    step3: '3. Text',
    step1Title: 'Message Type & Category',
    messageTypeLabel: 'Message Type',
    referenceNotamLabel: 'Reference NOTAM (e.g., A1234/24)',
    categoryLabel: 'Category',
    selectCategoryPlaceholder: 'Select a category...',
    category_AERO: 'Aerodrome/En-route/Obstacle',
    category_COM: 'Communications and Radar',
    category_NAV: 'Navigation Warnings',
    category_OTHER: 'Other',
    subjectLabel: 'Subject',
    selectSubjectPlaceholder: 'Select a subject...',
    conditionLabel: 'Condition',
    selectConditionPlaceholder: 'Select a condition...',
    step2Title: 'Core Information',
    itemALabel: 'A) Location (Aerodrome ICAO or FIR code)',
    itemBLabel: 'B) UTC Start (YYYYMMDDhhmm)',
    itemCLabel: 'C) UTC End (YYYYMMDDhhmm or PERM)',
    itemDLabel: 'D) Schedule (Optional)',
    scheduleFrequencyLabel: 'Frequency',
    scheduleSelectFreqPlaceholder: 'Select...',
    freq_DAILY: 'Daily',
    freq_MON: 'Monday',
    freq_TUE: 'Tuesday',
    freq_WED: 'Wednesday',
    freq_THU: 'Thursday',
    freq_FRI: 'Friday',
    freq_SAT: 'Saturday',
    freq_SUN: 'Sunday',
    scheduleStartTimeLabel: 'Start Time (UTC)',
    scheduleEndTimeLabel: 'End Time (UTC)',
    itemFLabel: 'F) Lower Vertical Limit (e.g., 000, FL050)',
    itemGLabel: 'G) Upper Vertical Limit (e.g., 999, FL180)',
    step3Title: 'Details & Final Text',
    rwyDesignatorLabel: 'Runway Designator',
    twyDesignatorLabel: 'Taxiway Designator',
    apronDesignatorLabel: 'Apron Designator',
    navaidIdLabel: 'Navaid ID & Type',
    airspaceNameLabel: 'Airspace Name/Type',
    airspaceCoordsLabel: 'Coordinates / Radius',
    obstacleTypeLabel: 'Obstacle Type',
    obstaclePositionLabel: 'Obstacle Position',
    obstacleHeightLabel: 'Height / Elevation',
    lightingLabel: 'Lighting',
    lighted: 'Lighted',
    notLighted: 'Not Lighted',
    itemELabel: 'E) NOTAM Text',
    itemEHelpText: 'Auto-generated based on inputs. You can edit this text directly.',
    prevButton: 'Previous',
    nextButton: 'Next',
    resetButton: 'Reset',
    showButton: 'Generate NOTAM',
    previewTitle: 'Final NOTAM Preview',
    copyTooltip: 'Copy to clipboard',
    downloadTooltip: 'Download as .txt',
    modalTitle: 'Generated NOTAM',
    closeButton: 'Close',
  },
  fr: {
    title: 'Générateur de NOTAM OACI',
    templatesTitle: 'Modèles rapides',
    selectTemplatePlaceholder: 'Sélectionnez un modèle...',
    template_rwy_clsd: 'Piste fermée',
    template_twy_wip: 'Voie de circulation en travaux',
    template_vor_unserv: 'VOR hors service',
    step1: '1. Type',
    step2: '2. Détails',
    step3: '3. Texte',
    step1Title: 'Type et catégorie du message',
    messageTypeLabel: 'Type de message',
    referenceNotamLabel: 'NOTAM de référence (ex: A1234/24)',
    categoryLabel: 'Catégorie',
    selectCategoryPlaceholder: 'Sélectionnez une catégorie...',
    category_AERO: 'Aérodrome/En route/Obstacle',
    category_COM: 'Communications et radar',
    category_NAV: 'Avertissements de navigation',
    category_OTHER: 'Autre',
    subjectLabel: 'Sujet',
    selectSubjectPlaceholder: 'Sélectionnez un sujet...',
    conditionLabel: 'Condition',
    selectConditionPlaceholder: 'Sélectionnez une condition...',
    step2Title: 'Informations de base',
    itemALabel: 'A) Emplacement (Code OACI aérodrome ou FIR)',
    itemBLabel: 'B) Début UTC (AAAAMMJJhhmm)',
    itemCLabel: 'C) Fin UTC (AAAAMMJJhhmm ou PERM)',
    itemDLabel: 'D) Horaire (Facultatif)',
    scheduleFrequencyLabel: 'Fréquence',
    scheduleSelectFreqPlaceholder: 'Sélection...',
    freq_DAILY: 'Quotidien',
    scheduleStartTimeLabel: 'Heure de début (UTC)',
    scheduleEndTimeLabel: 'Heure de fin (UTC)',
    itemFLabel: 'F) Limite verticale inférieure',
    itemGLabel: 'G) Limite verticale supérieure',
    step3Title: 'Détails et texte final',
    itemELabel: 'E) Texte du NOTAM',
    itemEHelpText: 'Généré automatiquement. Vous pouvez modifier ce texte.',
    prevButton: 'Précédent',
    nextButton: 'Suivant',
    resetButton: 'Réinitialiser',
    showButton: 'Générer NOTAM',
    previewTitle: 'Aperçu final du NOTAM',
    copyTooltip: 'Copier dans le presse-papiers',
    downloadTooltip: 'Télécharger en .txt',
    modalTitle: 'NOTAM généré',
    closeButton: 'Fermer',
  },
  pt: {
    title: 'Construtor de NOTAM ICAO',
    templatesTitle: 'Modelos Rápidos',
    selectTemplatePlaceholder: 'Selecione um modelo...',
    template_rwy_clsd: 'Pista Fechada',
    template_twy_wip: 'Taxiway em Obras',
    template_vor_unserv: 'VOR Inoperante',
    step1: '1. Tipo',
    step2: '2. Detalhes',
    step3: '3. Texto',
    step1Title: 'Tipo e Categoria da Mensagem',
    messageTypeLabel: 'Tipo de Mensagem',
    referenceNotamLabel: 'NOTAM de Referência (ex: A1234/24)',
    categoryLabel: 'Categoria',
    selectCategoryPlaceholder: 'Selecione uma categoria...',
    category_AERO: 'Aeródromo/Em Rota/Obstáculo',
    category_COM: 'Comunicações e Radar',
    category_NAV: 'Avisos de Navegação',
    category_OTHER: 'Outro',
    subjectLabel: 'Assunto',
    selectSubjectPlaceholder: 'Selecione um assunto...',
    conditionLabel: 'Condição',
    selectConditionPlaceholder: 'Selecione uma condição...',
    step2Title: 'Informações Principais',
    itemALabel: 'A) Localização (Código ICAO do Aeródromo ou FIR)',
    itemBLabel: 'B) Início UTC (AAAAMMDDhhmm)',
    itemCLabel: 'C) Fim UTC (AAAAMMDDhhmm ou PERM)',
    itemDLabel: 'D) Horário (Opcional)',
    scheduleFrequencyLabel: 'Frequência',
    scheduleSelectFreqPlaceholder: 'Selecione...',
    freq_DAILY: 'Diário',
    scheduleStartTimeLabel: 'Hora de Início (UTC)',
    scheduleEndTimeLabel: 'Hora de Fim (UTC)',
    itemFLabel: 'F) Limite Vertical Inferior',
    itemGLabel: 'G) Limite Vertical Superior',
    step3Title: 'Detalhes e Texto Final',
    itemELabel: 'E) Texto do NOTAM',
    itemEHelpText: 'Gerado automaticamente. Você pode editar este texto.',
    prevButton: 'Anterior',
    nextButton: 'Próximo',
    resetButton: 'Resetar',
    showButton: 'Gerar NOTAM',
    previewTitle: 'Pré-visualização Final do NOTAM',
    copyTooltip: 'Copiar para a área de transferência',
    downloadTooltip: 'Baixar como .txt',
    modalTitle: 'NOTAM Gerado',
    closeButton: 'Fechar',
  },
  sw: {
    title: 'Mjenzi wa NOTAM wa ICAO',
    templatesTitle: 'Violezo vya Haraka',
    selectTemplatePlaceholder: 'Chagua kiolezo...',
    template_rwy_clsd: 'Njia ya Ndege Imefungwa',
    template_twy_wip: 'Njia ya Teksi Inaendelea Kazi',
    template_vor_unserv: 'VOR Haitumiki',
    step1: '1. Aina',
    step2: '2. Maelezo',
    step3: '3. Maandishi',
    step1Title: 'Aina ya Ujumbe na Kitengo',
    messageTypeLabel: 'Aina ya Ujumbe',
    referenceNotamLabel: 'NOTAM ya Marejeleo (k.m., A1234/24)',
    categoryLabel: 'Kitengo',
    selectCategoryPlaceholder: 'Chagua kitengo...',
    category_AERO: 'Uwanja wa Ndege/Njia/Kizuizi',
    category_COM: 'Mawasiliano na Rada',
    category_NAV: 'Maonyo ya Urambazaji',
    category_OTHER: 'Nyingine',
    subjectLabel: 'Mada',
    selectSubjectPlaceholder: 'Chagua mada...',
    conditionLabel: 'Hali',
    selectConditionPlaceholder: 'Chagua hali...',
    step2Title: 'Taarifa za Msingi',
    itemALabel: 'A) Mahali (Msimbo wa ICAO wa Uwanja wa Ndege au FIR)',
    itemBLabel: 'B) Mwanzo UTC (YYYYMMDDhhmm)',
    itemCLabel: 'C) Mwisho UTC (YYYYMMDDhhmm au PERM)',
    itemDLabel: 'D) Ratiba (Si lazima)',
    scheduleFrequencyLabel: 'Marudio',
    scheduleSelectFreqPlaceholder: 'Chagua...',
    freq_DAILY: 'Kila siku',
    scheduleStartTimeLabel: 'Saa ya Kuanza (UTC)',
    scheduleEndTimeLabel: 'Saa ya Mwisho (UTC)',
    itemFLabel: 'F) Kikomo cha Chini cha Wima',
    itemGLabel: 'G) Kikomo cha Juu cha Wima',
    step3Title: 'Maelezo na Maandishi ya Mwisho',
    itemELabel: 'E) Maandishi ya NOTAM',
    itemEHelpText: 'Imetengenezwa kiotomatiki. Unaweza kuhariri maandishi haya.',
    prevButton: 'Nyuma',
    nextButton: 'Mbele',
    resetButton: 'Weka Upya',
    showButton: 'Tengeneza NOTAM',
    previewTitle: 'Onyesho la Mwisho la NOTAM',
    copyTooltip: 'Nakili kwenye ubao wa kunakili',
    downloadTooltip: 'Pakua kama .txt',
    modalTitle: 'NOTAM Iliyotengenezwa',
    closeButton: 'Funga',
  }
};


@Injectable({
  providedIn: 'root'
})
export class TranslationService {
  availableLanguages = [
    { code: 'en' as Language, name: 'English' },
    { code: 'fr' as Language, name: 'Français' },
    { code: 'pt' as Language, name: 'Português' },
    { code: 'sw' as Language, name: 'Swahili' },
  ];

  language = signal<Language>('en');

  t = computed(() => {
    // Fallback to English if a translation is missing
    return new Proxy(TRANSLATIONS[this.language()], {
      get(target, prop: string) {
        return target[prop] || TRANSLATIONS.en[prop] || prop;
      }
    });
  });

  setLanguage(lang: Language) {
    this.language.set(lang);
  }
}
